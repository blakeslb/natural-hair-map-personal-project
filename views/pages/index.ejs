<%- include('../partials/head') -%>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDKEZCz730qwqKPlvJkYEMWkXfqPPR2zeA&callback=initMap&libraries=&v=weekly"
            async></script>

  <!-- <i class="fas fa-bars fa-2x" id="hambubrger-icon"></i> -->

  <!-- Large container wraps all others -->
  <div class="wrap-container">
    
    <!-- left container -->
    <div class="left-container">
      <h3>HOW TO USE THIS MAP</h3>
      <ol>
        <li>Use the cursor to navigate and zoom into map by the desired neighborhood or area. </li>
        <li>Stylists are represented by icons. Click the icon to view information about a listing.</li>
        <li>View a stylist's information and/or leave a comment for others to see!</li>
      </ol>
    </div>

    <!-- middle container div element for map -->
    <div class="middle-container">
      <div id="map"> </div>

      <script>

let data = <%- JSON.stringify(data) %>;



        const boston = { lat: 42.3601, lng: -71.0589 };
        //   const map = new google.maps.Map(document.getElementById("map"), {
        //   zoom: 12,
        //   center: boston,
        // });

        let map;
        function initMap() {
          const boston = { lat: 42.3601, lng: -71.0589 };
          const map = new google.maps.Map(document.getElementById("map"), {
            zoom: 12,
            center: boston,
          });

          for(each of data) {

            if (each.isApproved)  {

            latLng=each.coords;
            latLng = latLng.replace("(", "");
            latLng = latLng.replace(")", "");
            latLng = latLng.split(",")

            lat = Number(latLng[0])
            long = Number(latLng[1])

            console.log(latLng);

          
         const marker = new google.maps.Marker({
          position: new google.maps.LatLng(lat, long),
          map,
            title: each.fullName,
            
          });


          const contentString =
    `<div id="markerContent">` +
    `<h1>${each.fullName}</h1>` +
    `<div><p>${each.address}</p></div>` +
    `<div><a href = ${each.website}>${each.website}</div>` +
  
    "</div>";
       

          const infowindow = new google.maps.InfoWindow({
          content: contentString
          
          });
          marker.addListener("click", () => {
          infowindow.open(map, marker);
     
        });
      }
        } //closes loop

        } //close init map function
        
      </script>



      
    </div>

    <div class = "lcards">
      <% data.forEach(stylist => { %>
        <%- include('../partials/marker', {stylist: stylist}) -%>
                <% }); %>



    </div>

    <!-- right container directory listing section -->
    <!-- <%- include('../partials/listing') -%> -->
  </div>
  <%- include('../partials/footer') -%>